<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>哲学者の名言集</title>
  <meta name="description" content="有名な哲学者の名言を検索・絞り込み・ランダム表示できるシンプルな名言集サイト。" />
  <style>
    :root{
      --bg:#0b0c10;
      --panel:#12141b;
      --panel2:#0f1117;
      --text:#e9ecf1;
      --muted:#a8b0bd;
      --line:#232733;
      --accent:#7aa2ff;
      --accent2:#7cffc9;
      --warn:#ffcc66;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --max: 1100px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Meiryo", Arial, sans-serif;
    }
    [data-theme="light"]{
      --bg:#f7f8fb;
      --panel:#ffffff;
      --panel2:#fbfcff;
      --text:#10131a;
      --muted:#5a6474;
      --line:#e6e8ef;
      --accent:#2b64ff;
      --accent2:#00a37a;
      --shadow: 0 10px 26px rgba(16,19,26,.12);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 20% 0%, rgba(122,162,255,.18), transparent 55%),
                  radial-gradient(900px 500px at 80% 10%, rgba(124,255,201,.12), transparent 60%),
                  var(--bg);
      color:var(--text);
      font-family: var(--sans);
      line-height:1.55;
    }
    a{color:var(--accent)}
    .wrap{max-width:var(--max); margin:0 auto; padding:24px 16px 60px;}
    header{
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap;
      padding:18px 18px; border:1px solid var(--line); border-radius:var(--radius);
      background:linear-gradient(180deg, rgba(255,255,255,.04), transparent 60%), var(--panel);
      box-shadow: var(--shadow);
    }
    .title h1{margin:0; font-size:22px; letter-spacing:.2px}
    .title p{margin:6px 0 0; color:var(--muted); font-size:13px}
    .actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    button, select, input{
      border:1px solid var(--line);
      background:var(--panel2);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      font-size:14px;
      outline:none;
    }
    input{min-width: 220px}
    select{min-width: 160px}
    button{cursor:pointer}
    button.primary{
      background:linear-gradient(180deg, rgba(122,162,255,.35), rgba(122,162,255,.12)), var(--panel2);
      border-color: rgba(122,162,255,.5);
    }
    button.good{
      background:linear-gradient(180deg, rgba(124,255,201,.28), rgba(124,255,201,.10)), var(--panel2);
      border-color: rgba(124,255,201,.5);
    }
    button.ghost{background:transparent}
    button:active{transform: translateY(1px)}
    .grid{
      margin-top:18px;
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media (min-width: 860px){
      .grid{grid-template-columns: 1fr 1fr;}
    }
    .card{
      border:1px solid var(--line);
      border-radius:var(--radius);
      background: var(--panel);
      padding:16px 16px 14px;
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .quote{
      font-size:16px;
      margin:0 0 10px;
      padding-left:12px;
      border-left:3px solid rgba(122,162,255,.6);
    }
    .meta{
      display:flex; flex-wrap:wrap; gap:8px 10px; align-items:center;
      color:var(--muted); font-size:13px;
    }
    .pill{
      font-size:12px;
      color:var(--text);
      border:1px solid var(--line);
      padding:4px 8px;
      border-radius:999px;
      background: rgba(255,255,255,.03);
    }
    .row{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
      margin-top:12px;
    }
    .mini{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
    }
    .mini button{
      padding:8px 10px; border-radius:10px; font-size:13px;
    }
    .star{
      position:absolute; top:12px; right:12px;
      border-radius:999px;
      padding:7px 10px;
      font-family: var(--mono);
    }
    .countbar{
      margin-top:14px;
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      color:var(--muted); font-size:13px;
    }
    .toast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%);
      background: var(--panel);
      border: 1px solid var(--line);
      padding: 10px 12px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      color: var(--text);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease, transform .18s ease;
      max-width: min(520px, calc(100vw - 24px));
      font-size: 14px;
    }
    .toast.show{opacity: 1; transform: translateX(-50%) translateY(-6px);}
    footer{
      margin-top:18px;
      color:var(--muted);
      font-size:12.5px;
      border:1px solid var(--line);
      border-radius:var(--radius);
      background: var(--panel);
      padding:14px 16px;
    }
    .kbd{
      font-family: var(--mono);
      font-size: 12px;
      padding: 2px 6px;
      border: 1px solid var(--line);
      border-radius: 8px;
      background: rgba(255,255,255,.03);
      color: var(--text);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>哲学者の名言集</h1>
        <p>検索・絞り込み・ランダム表示・お気に入り保存（このPCのブラウザに保存）</p>
      </div>

      <div class="actions">
        <input id="q" placeholder="検索（例：幸福 / freedom / Nietzsche）" />
        <select id="author"></select>
        <select id="tag"></select>
        <button class="primary" id="randomBtn">ランダム</button>
        <button class="good" id="favToggle">★ お気に入りだけ</button>
        <button class="ghost" id="clearBtn">クリア</button>
        <button class="ghost" id="themeBtn" title="ダーク/ライト切替">テーマ切替</button>
      </div>

      <div class="countbar" id="countbar"></div>
    </header>

    <main class="grid" id="list"></main>

    <footer>
      <div><strong>追加のしかた：</strong>このファイル内の <span class="kbd">quotes</span> 配列に1件追加するだけ。</div>
      <div style="margin-top:8px;">
        <strong>著作権の注意：</strong>古典の原文は多くがパブリックドメインでも、<em>日本語訳（翻訳文）</em>は近年のものだと著作権がある場合があります。
        このサイトに載せるなら「自分で意訳する」「パブリックドメインの訳を使う」「権利者の許諾を取る」が安全です。
      </div>
      <div style="margin-top:8px;">ショートカット：<span class="kbd">/</span> で検索欄へ</div>
    </footer>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // ===== 名言データ（ここを増やす）=====
    // note: 日本語は意訳（著作権リスクを避けるため）。必要なら原文（英語/ラテン語等）も併記推奨。
    const quotes = [
      {
        id: "socrates-001",
        author: "ソクラテス",
        era: "古代",
        tags: ["自己省察", "生き方"],
        text: "吟味しない人生は、十分に生きたとは言えない。",
        original: "The unexamined life is not worth living.",
        source: "プラトン『ソクラテスの弁明』(Apology)",
      },
      {
        id: "plato-001",
        author: "プラトン",
        era: "古代",
        tags: ["知", "教育"],
        text: "知は、魂をより良い方向へ向ける力だ。",
        original: "",
        source: "（要旨）『国家』などに見られる知と善の議論",
      },
      {
        id: "aristotle-001",
        author: "アリストテレス",
        era: "古代",
        tags: ["徳", "習慣", "生き方"],
        text: "私たちは、繰り返し行うことの総体だ。だから卓越は行為の習慣に宿る。",
        original: "We are what we repeatedly do. Excellence, then, is not an act, but a habit.",
        source: "（広く流布する要約表現。原典は『ニコマコス倫理学』の徳と習慣の議論）",
      },
      {
        id: "descartes-001",
        author: "デカルト",
        era: "近代",
        tags: ["知", "懐疑"],
        text: "疑うことができるなら、考えている。考えているなら、私がいる。",
        original: "Cogito, ergo sum.",
        source: "『省察』(Meditations) / 『方法序説』",
      },
      {
        id: "kant-001",
        author: "カント",
        era: "近代",
        tags: ["倫理", "理性"],
        text: "人は手段ではなく、目的として尊重されるべきだ。",
        original: "",
        source: "『道徳形而上学の基礎づけ』の趣旨",
      },
      {
        id: "hume-001",
        author: "ヒューム",
        era: "近代",
        tags: ["因果", "経験"],
        text: "因果は“見えるもの”ではなく、経験の繰り返しから心が作る期待でもある。",
        original: "",
        source: "『人間知性研究』の因果論の趣旨",
      },
      {
        id: "nietzsche-001",
        author: "ニーチェ",
        era: "近代",
        tags: ["逆境", "生き方"],
        text: "自分を壊さない苦しみは、かえって自分を強くすることがある。",
        original: "That which does not kill us makes us stronger.",
        source: "『偶像の黄昏』(Twilight of the Idols)",
      },
      {
        id: "marcus-001",
        author: "マルクス・アウレリウス",
        era: "古代",
        tags: ["ストア", "心"],
        text: "あなたを乱すのは出来事ではなく、出来事への捉え方だ。",
        original: "",
        source: "『自省録』の趣旨（ストア派的要点）",
      },
      {
        id: "confucius-001",
        author: "孔子",
        era: "古代",
        tags: ["学び", "継続"],
        text: "学び続け、折々に確かめる。そこに喜びがある。",
        original: "",
        source: "『論語』学而篇の趣旨",
      },
      {
        id: "wittgenstein-001",
        author: "ウィトゲンシュタイン",
        era: "現代",
        tags: ["言語", "限界"],
        text: "言葉の届く範囲が、世界の見え方の範囲になる。",
        original: "The limits of my language mean the limits of my world.",
        source: "『論理哲学論考』(Tractatus)",
      },
    ];

    // ===== 状態 =====
    const elList = document.getElementById("list");
    const elQ = document.getElementById("q");
    const elAuthor = document.getElementById("author");
    const elTag = document.getElementById("tag");
    const elCountbar = document.getElementById("countbar");
    const elToast = document.getElementById("toast");

    const LS_KEY_FAV = "philo_favorites_v1";
    const LS_KEY_THEME = "philo_theme_v1";

    let showFavOnly = false;

    const getFavs = () => {
      try { return new Set(JSON.parse(localStorage.getItem(LS_KEY_FAV) || "[]")); }
      catch { return new Set(); }
    };
    const setFavs = (set) => localStorage.setItem(LS_KEY_FAV, JSON.stringify([...set]));
    let favs = getFavs();

    // ===== UI補助 =====
    function toast(msg){
      elToast.textContent = msg;
      elToast.classList.add("show");
      setTimeout(() => elToast.classList.remove("show"), 1600);
    }

    function normalize(s){
      return (s || "")
        .toString()
        .toLowerCase()
        .replace(/\s+/g, " ")
        .trim();
    }

    function unique(arr){
      return [...new Set(arr)].sort((a,b)=>a.localeCompare(b, "ja"));
    }

    // ===== セレクト初期化 =====
    function initSelects(){
      const authors = ["すべて", ...unique(quotes.map(x => x.author))];
      elAuthor.innerHTML = authors.map(a => `<option value="${escapeHtml(a)}">${escapeHtml(a)}</option>`).join("");

      const tags = unique(quotes.flatMap(x => x.tags || []));
      const tagOptions = ["すべて", ...tags];
      elTag.innerHTML = tagOptions.map(t => `<option value="${escapeHtml(t)}">${escapeHtml(t)}</option>`).join("");
    }

    // ===== レンダリング =====
    function escapeHtml(str){
      return (str || "").replace(/[&<>"']/g, (m) => ({
        "&":"&amp;", "<":"&lt;", ">":"&gt;", '"':"&quot;", "'":"&#39;"
      }[m]));
    }

    function matches(item){
      const q = normalize(elQ.value);
      const a = elAuthor.value;
      const t = elTag.value;

      if (showFavOnly && !favs.has(item.id)) return false;
      if (a !== "すべて" && item.author !== a) return false;
      if (t !== "すべて" && !(item.tags || []).includes(t)) return false;

      if (!q) return true;

      const hay = normalize([
        item.text, item.original, item.author, item.era, item.source, (item.tags||[]).join(" ")
      ].join(" | "));

      return hay.includes(q);
    }

    function render(){
      const filtered = quotes.filter(matches);

      elCountbar.innerHTML = `
        <span>表示：<strong>${filtered.length}</strong> 件 / 全 <strong>${quotes.length}</strong> 件</span>
        <span>お気に入り：<strong>${favs.size}</strong> 件</span>
        <span>状態：${showFavOnly ? "★ お気に入りのみ" : "全件"} / テーマ：${document.documentElement.dataset.theme || "dark"}</span>
      `;

      elList.innerHTML = filtered.map(item => cardHtml(item)).join("");

      // カード内ボタンにイベント付与
      filtered.forEach(item => {
        document.getElementById(`copy-${item.id}`)?.addEventListener("click", () => copyQuote(item));
        document.getElementById(`fav-${item.id}`)?.addEventListener("click", () => toggleFav(item.id));
        document.getElementById(`rand-${item.id}`)?.addEventListener("click", () => focusQuote(item.id));
      });

      if (filtered.length === 0){
        elList.innerHTML = `
          <div class="card" style="grid-column: 1 / -1;">
            <p style="margin:0;color:var(--muted);">条件に一致する名言がありません。検索語や絞り込みを変えてみてください。</p>
          </div>
        `;
      }
    }

    function cardHtml(item){
      const isFav = favs.has(item.id);
      const tags = (item.tags || []).map(t => `<span class="pill">${escapeHtml(t)}</span>`).join("");
      const original = item.original ? `<div style="margin-top:8px;color:var(--muted);font-size:13px;"><span style="font-family:var(--mono)">原文:</span> ${escapeHtml(item.original)}</div>` : "";
      const src = item.source ? `<div style="margin-top:6px;color:var(--muted);font-size:12.5px;">出典: ${escapeHtml(item.source)}</div>` : "";

      return `
        <section class="card" id="card-${escapeHtml(item.id)}">
          <button class="star ${isFav ? "good" : "ghost"}" id="fav-${escapeHtml(item.id)}" title="お気に入り">
            ${isFav ? "★" : "☆"}
          </button>

          <p class="quote">「${escapeHtml(item.text)}」</p>

          <div class="meta">
            <span><strong>${escapeHtml(item.author)}</strong></span>
            <span>・</span>
            <span>${escapeHtml(item.era || "")}</span>
            ${tags ? `<span style="margin-left:4px;display:flex;gap:6px;flex-wrap:wrap;">${tags}</span>` : ""}
          </div>

          ${original}
          ${src}

          <div class="row">
            <div class="mini">
              <button id="copy-${escapeHtml(item.id)}">コピー</button>
              <button class="ghost" id="rand-${escapeHtml(item.id)}" title="このカードへ移動">カードへ</button>
            </div>
            <div class="meta">
              <span style="font-family:var(--mono);font-size:12px;">id: ${escapeHtml(item.id)}</span>
            </div>
          </div>
        </section>
      `;
    }

    // ===== 操作 =====
    function toggleFav(id){
      if (favs.has(id)) favs.delete(id);
      else favs.add(id);
      setFavs(favs);
      render();
      toast(favs.has(id) ? "お気に入りに追加しました" : "お気に入りから外しました");
    }

    function pickRandomVisible(){
      const visible = quotes.filter(matches);
      if (visible.length === 0) return null;
      return visible[Math.floor(Math.random() * visible.length)];
    }

    function focusQuote(id){
      const el = document.getElementById(`card-${id}`);
      if (!el) return;
      el.scrollIntoView({behavior:"smooth", block:"center"});
      el.animate([{transform:"scale(1)"},{transform:"scale(1.01)"},{transform:"scale(1)"}], {duration: 260});
    }

    async function copyQuote(item){
      const text =
`「${item.text}」
— ${item.author}
${item.original ? "Original: " + item.original + "\n" : ""}${item.source ? "Source: " + item.source : ""}`.trim();

      // Clipboard API（https/localhostが基本）。file:// の場合は失敗することがあるのでフォールバック付き。
      try{
        await navigator.clipboard.writeText(text);
        toast("コピーしました");
        return;
      }catch(e){
        // fallback: textarea
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        document.body.appendChild(ta);
        ta.select();
        try{
          document.execCommand("copy");
          toast("コピーしました（互換モード）");
        }catch{
          toast("コピーに失敗しました。手動で選択してください。");
        }finally{
          document.body.removeChild(ta);
        }
      }
    }

    function setTheme(theme){
      document.documentElement.dataset.theme = theme;
      localStorage.setItem(LS_KEY_THEME, theme);
      render();
    }

    // ===== イベント =====
    document.getElementById("randomBtn").addEventListener("click", () => {
      const item = pickRandomVisible();
      if (!item) return toast("表示できる名言がありません");
      focusQuote(item.id);
      toast(`ランダム：${item.author}`);
    });

    document.getElementById("clearBtn").addEventListener("click", () => {
      elQ.value = "";
      elAuthor.value = "すべて";
      elTag.value = "すべて";
      showFavOnly = false;
      document.getElementById("favToggle").textContent = "★ お気に入りだけ";
      render();
      toast("条件をクリアしました");
    });

    document.getElementById("favToggle").addEventListener("click", () => {
      showFavOnly = !showFavOnly;
      document.getElementById("favToggle").textContent = showFavOnly ? "★ 全件に戻す" : "★ お気に入りだけ";
      render();
    });

    document.getElementById("themeBtn").addEventListener("click", () => {
      const cur = document.documentElement.dataset.theme || "dark";
      setTheme(cur === "dark" ? "light" : "dark");
      toast(`テーマ：${document.documentElement.dataset.theme}`);
    });

    [elQ, elAuthor, elTag].forEach(el => el.addEventListener("input", render));
    [elAuthor, elTag].forEach(el => el.addEventListener("change", render));

    // "/" で検索へ
    window.addEventListener("keydown", (e) => {
      if (e.key === "/" && document.activeElement !== elQ){
        e.preventDefault();
        elQ.focus();
      }
    });

    // ===== 初期化 =====
    initSelects();
    const savedTheme = localStorage.getItem(LS_KEY_THEME);
    if (savedTheme) document.documentElement.dataset.theme = savedTheme;
    else document.documentElement.dataset.theme = "dark";
    render();
  </script>
</body>
</html>
